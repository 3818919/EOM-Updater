<!DOCTYPE html>
<html>

<head>
    <title>Endless Memories Client Updater</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }

        progress {
            width: 100%;
            height: 20px;
        }
    </style>
</head>

<body>
    <h1>Endless Memories Client Updater</h1>
    <progress id="progressBar" value="0" max="100"></progress>
    <pre id="output"></pre>

    <script>
        const { ipcRenderer } = require('electron');

        function log(msg) {
            const out = document.getElementById('output');
            out.textContent += `\n${msg}`;
        }

        ipcRenderer.on('sync-progress', (_, msg) => log(msg));
        ipcRenderer.on('sync-progress-percent', (_, percent) => {
            document.getElementById('progressBar').value = percent;
        });

        ipcRenderer.on('auto-start-sync', () => {
            document.getElementById('output').textContent = '';
            document.getElementById('progressBar').value = 0;
            ipcRenderer.invoke('start-sync', { localDir: '' })
                .then(msg => log(msg))
                .catch(err => log('Error: ' + err));
        });
    </script>
</body>

</html>